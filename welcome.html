<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Página de Login</title>
    <script>
        async function signIn(event) {
            event.preventDefault(); // Previne o comportamento padrão do formulário

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // Formatar os dados para envio no formato application/x-www-form-urlencoded
            const params = new URLSearchParams();
            params.append('username', username);
            params.append('password', password);

            try {
                const response = await fetch('http://192.168.1.8:8080/sign-in', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: params.toString(),
                });

                const text = await response.text();

                if (text === 'OK') {
                    // Salvar o nome de usuário no localStorage para usar na próxima página
                    localStorage.setItem('username', username);
                    // Redirecionar para a página de boas-vindas
                    window.location.href = 'welcome.html';
                } else if (text === 'UAE') {
                    alert('Username já existe. Tente novamente.');
                } else if (text === 'UTS') {
                    alert('Username deve ter 4 ou mais caracteres.');
                } else if (text === 'PTS') {
                    alert('Password deve ter 4 ou mais caracteres.');
                } else if (text === 'PMCC') {
                    alert('A senha deve conter ao menos uma letra maiúscula.');
                } else if (text === 'PMCS') {
                    alert('A senha deve conter ao menos um caractere especial.');
                } else {
                    alert('erro desconhecido');
                }
            } catch (error) {
                console.error('Erro ao fazer sign-in:', error);
                alert('Erro ao fazer sign-in. Verifique o console para mais detalhes.');
            }
        }
    </script>
</head>
<body>
    <h1>Página de Sign-in</h1>
    <form onsubmit="signIn(event)">
        <label for="username">Nome de Usuário:</label><br>
        <input type="text" id="username" name="username" required><br><br>

        <label for="password">Senha:</label><br>
        <input type="password" id="password" name="password" required><br><br>

        <button type="submit">sign in</button>
    </form>
</body>
</html>